package br.com.desafio.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import br.com.desafio.config.BDConfig;
import br.com.desafio.entidade.Pessoa;

public class PessoaDAO {

	public List<Pessoa> listarPessoas() throws Exception {
		List<Pessoa> lista = new ArrayList()<>();
		
		Connection con = BDConfig.getConnection();
		
		String sql = "SELECT * FROM PESSOA";
		
		PreparedStatement statement = con.prepareStatement(sql);
		ResultSet rs = statement.executeQuery();
		
		while(rs.next()) {
			Pessoa pessoa = new Pessoa();
			pessoa.setId(rs.getInt("id"));
			pessoa.setFirst_name(rs.getString("first_name"));
			pessoa.setLast_name(rs.getString("last_name"));
			pessoa.setAge(rs.getInt("age"));
			
			lista.add(pessoa);
		}
		return lista;
	}

}
